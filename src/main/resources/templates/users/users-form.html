<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/base :: conteudo">

<div th:fragment="conteudo">

    <h2 th:text="${user.id != null ? 'Editar Usuário' : 'Novo Usuário'}"></h2>

    <form th:action="@{/users/save}" th:object="${user}" method="post">

        <input type="hidden" th:field="*{id}">

        <div class="mb-3">
            <label class="form-label">Username</label>
            <input type="text" class="form-control" th:field="*{username}" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Senha</label>
            <input type="password" class="form-control" th:field="*{password}"
                   th:placeholder="${user.id != null ? 'Deixe em branco para manter' : ''}">
        </div>

        <div class="mb-3">
            <label class="form-label">Funções (Roles)</label>
            <select name="rolesIds" class="form-select" multiple size="5" required>
                <option th:each="r : ${roles}"
                        th:value="${r.id}"
                        th:selected="${user.roles != null and user.roles.contains(r)}"
                        th:text="${r.name}">
                </option>
            </select>
            <small class="text-muted">Segure CTRL para selecionar vários.</small>
        </div>

        <button class="btn btn-success">Salvar</button>
        <a class="btn btn-secondary" th:href="@{/users/list}">Voltar</a>

    </form>

</div>
</html>
